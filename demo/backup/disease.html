<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>常见疾病</title>
<link rel="stylesheet" type="text/css" href='style.css' />
<link rel="stylesheet" type="text/css" href='bootstrap.css' />
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="bootstrap.min.js"></script>
<script type="text/javascript" src="jquery.ztree.core-3.5.js"></script>
<link rel="stylesheet" type="text/css" href='zTreeStyle.css' />

<body>

<div id="top">
	
    <div id="log">
    	
    </div>
    
</div>


<div style="height:50px; width:100%; background-image:url(images/ul-bg.jpg); background-repeat:repeat-x">
    <ul id="nav">
    	<li><a href="/demo/">首&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;页</a></li>
        <li><a>渔业疾病</a></li>
        <li><a>在线诊断</a></li>
        <li><a>预防控制</a></li>
        <li><a>省市平台</a></li>
        <li><a>关于我们</a></li> 
        <li style="width:250px;padding:5px; height:45px; font-weight:normal">
                <form class="form-inline input-group" method="get" action="http://www.baidu.com/baidu?"> 
                                 <input type="text" class="form-control" placeholder="输入关键词" style="width:150px;" name="word"/>   
                                 <button type="submit" class="btn btn-primary"><i class="icon-search"></i>搜索</button>           
                </form>
        </li> 
    </ul>
<div>

<div id="main">
 <script type="text/javascript">
        var setting = {
            view: {
                showLine: true,
                selectedMulti: false,
                dblClickExpand: false
            },
            data: {
                simpleData: {
                    enable: true,
					pIdKey: "pid"
                }
            }
            , callback: {
                beforeExpand: beforeExpand,
                onExpand: onExpand,
                onClick: onClick
            }
        };
       
        $(document).ready(function () {
            createTree(1);
            if(''!='')
            {
                getContent('');
            }

       });
       var zTree = null;
       function beforeClick(treeId, treeNode, clickFlag) {
         
       }

       var curExpandNode = null;
       function beforeExpand(treeId, treeNode) {
           var pNode = curExpandNode ? curExpandNode.getParentNode() : null;
           var treeNodeP = treeNode.parentTId ? treeNode.getParentNode() : null;
           var zTree = $.fn.zTree.getZTreeObj("treeDemo");
           for (var i = 0, l = !treeNodeP ? 0 : treeNodeP.children.length; i < l; i++) {
               if (treeNode !== treeNodeP.children[i]) {
                   zTree.expandNode(treeNodeP.children[i], false);
               }
           }
           while (pNode) {
               if (pNode === treeNode) {
                   break;
               }
               pNode = pNode.getParentNode();
           }
           if (!pNode) {
               singlePath(treeNode);
           }

       }
       function singlePath(newNode) {
           if (newNode === curExpandNode) return;

           var zTree = $.fn.zTree.getZTreeObj("treeDemo"),
                   rootNodes, tmpRoot, tmpTId, i, j, n;

           if (!curExpandNode) {
               tmpRoot = newNode;
               while (tmpRoot) {
                   tmpTId = tmpRoot.tId;
                   tmpRoot = tmpRoot.getParentNode();
               }
               rootNodes = zTree.getNodes();
               for (i = 0, j = rootNodes.length; i < j; i++) {
                   n = rootNodes[i];
                   if (n.tId != tmpTId) {
                       zTree.expandNode(n, false);
                   }
               }
           } else if (curExpandNode && curExpandNode.open) {
               if (newNode.parentTId === curExpandNode.parentTId) {
                   zTree.expandNode(curExpandNode, false);
               } else {
                   var newParents = [];
                   while (newNode) {
                       newNode = newNode.getParentNode();
                       if (newNode === curExpandNode) {
                           newParents = null;
                           break;
                       } else if (newNode) {
                           newParents.push(newNode);
                       }
                   }
                   if (newParents != null) {
                       var oldNode = curExpandNode;
                       var oldParents = [];
                       while (oldNode) {
                           oldNode = oldNode.getParentNode();
                           if (oldNode) {
                               oldParents.push(oldNode);
                           }
                       }
                       if (newParents.length > 0) {
                           zTree.expandNode(oldParents[Math.abs(oldParents.length - newParents.length) - 1], false);
                       } else {
                           zTree.expandNode(oldParents[oldParents.length - 1], false);
                       }
                   }
               }
           }
           curExpandNode = newNode;
       }

       function onExpand(event, treeId, treeNode) {
           curExpandNode = treeNode;
       }

       function onClick(event, treeId, treeNode, clickFlag) {
          
           if(treeNode.pid==null)
           {
               
               zTree.expandNode(treeNode, null, null, null, true);
           }
           else
           { 
               getContent(treeNode.id);
           }
       }
       function getContent(pid)
       {
          
           $.ajax({
               url: '/Diseases/GetContent', //url  action是方法的名称
               data: { id:pid},
               type: 'Get',
               dataType: "html",
               success: function (data) {

                   $("#content").html(data);
               },
               error: function (msg) {
                   alert(" 数据加载失败！" + msg);
               }
           });
       }


       function createTree(typeid) {
           $(".linkbtn").text("请选择");
           $("#linkbtn" + typeid).text("已选择");
           $("#diseasetype").text($("#linkdiv" + typeid + " a:first").text());
           $(".tabbtn").removeClass("selectlinkbtn");
            
           $("#linkdiv" + typeid).addClass("selectlinkbtn");

            $.ajax({
                url: '/Diseases/getdisease', //url  action是方法的名称
                data: { typeid: typeid },
                type: 'Get',
                dataType: "json",
                success: function (data) { 
                    zTree = $.fn.zTree.init($("#treeDemo"),setting,data.records);
                  var nodes = zTree.getNodes();
                  zTree.expandNode(nodes[0], true, null, null, null);

                },
                error: function (msg) {
                    alert(" 数据加载失败！" + msg);
                }
            });
        }
    </script>

    <div style="margin:0 auto; width:1000px; height:auto; min-height:700px; border:1px solid #ddd;background-image:url(images/title.jpg); background-repeat:repeat-x ">
           <div id="disease-top">
          	   <h3><img src="images/dt.png" >常见疾病</h3><hr>
              	<ul class="top">
                	<li onclick="createTree(1)">
                    	<div id="linkdiv1"  class="tabbtn">
                    <img src="images/fish1.png"/>
                    <p><a href="javascript:void(0)" >鱼类</a></p>
                    <a class="btn btn-primary linkbtn"  id="linkbtn1" >请选择</a> </div></li>
                    
                 	<li onclick="createTree(2)">
                    	<div id="linkdiv2" class="tabbtn">
                    <img src="images/fish2.png"/>
                    <p><a href="javascript:void(0)" >贝类</a></p>
                    <a class="btn btn-primary linkbtn"  id="linkbtn2">请选择</a></div></li>                   
                    
                 	<li onclick="createTree(3)">
                    	<div id="linkdiv3" class="tabbtn">
                    <img src="images/fish3.png"/>
                    <p><a href="javascript:void(0)" >甲壳类</a></p>
                    <a class="btn btn-primary linkbtn"  id="linkbtn3">请选择</a></div></li>                   
                    
                 	<li onclick="createTree(4)">
                    	<div id="linkdiv4" class="tabbtn">
                    <img src="images/fish4.png"/>
                    <p><a href="javascript:void(0)" >其他</a></p>
                    <a class="btn btn-primary linkbtn"  id="linkbtn4">请选择</a></div></li>                   
                </ul>
            </div>
            <div id="disease-content">
                	<h4><span id="diseasetype">鱼类</span>常见疾病描述及处理方法</h4>
                	<div class="left">
                        <div class="zTreeDemoBackground left">
                            <ul id="treeDemo" class="ztree"></ul>
                        </div>           
                    </div>
                
                	<div class="right">
                   		 <div id="content" style="padding:10px;">点击左侧查看详细信息</div>
                    
                    </div>
                
                </div>         

     </div>   
                   
</div>              
                   





<div id="foot">
	<p>版权所有：苏州益品德环境科技科技有限公司 地址:苏州工业园区</p>
	<p>网址：http://www.xxx.com 单位：苏州益品德环境科技科技有限公司</p>
	<p>Copyright (c) 2017-2020 All Rights Reserved [京ICP备05062206号-3]</p>
</div>







</body>
</html>
